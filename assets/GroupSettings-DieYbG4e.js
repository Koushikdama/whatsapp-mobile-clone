import{u as e,j as a}from"./index-BvqpNl34.js";import{u as s,b as r,r as t}from"./router-BlRKbG7o.js";import{g as l}from"./GroupService-DE6lM_uo.js";import{L as i,E as o,T as n,C as c}from"./UIFeedback-DmX0c331.js";import{y as d,aa as u,aA as m,D as x,ae as g,I as p,L as h,az as b,ak as f,T as y}from"./icons-DchmmGMJ.js";import"./react-vendor-Dp0kJvEn.js";import"./lottie-BmTBBIiw.js";import"./chess-Bi0BiJQc.js";const k=()=>{var k,w;const N=s(),{groupId:C}=r(),{chats:G,currentUser:D}=e(),[T,S]=t.useState(null),[A,L]=t.useState(!1),[U,E]=t.useState(!1),[P,z]=t.useState(!0),[M,F]=t.useState(null),[O,B]=t.useState(null),[I,$]=t.useState(!1),[Q,R]=t.useState(null);t.useEffect(()=>{Y()},[C]),t.useEffect(()=>{if(Q){const e=setTimeout(()=>R(null),3e3);return()=>clearTimeout(e)}},[Q]);const Y=async()=>{z(!0),F(null);try{const e=G.find(e=>e.id===C&&e.isGroup);if(e){S(e);const a=await l.isAdmin(C,null==D?void 0:D.id),s=await l.isOwner(C,null==D?void 0:D.id);L(a),E(s)}else F("Group not found")}catch(e){F("Failed to load group settings")}finally{z(!1)}},q=async()=>{var e;const a=(null==(e=null==T?void 0:T.settings)?void 0:e.muteUntil)&&new Date(T.settings.muteUntil)>new Date;try{const e=a?null:288e5;await l.muteGroup(C,e),R({type:"success",message:a?"Notifications unmuted":"Notifications muted for 8 hours"}),Y()}catch(s){R({type:"error",message:"Error updating mute status"})}};if(P)return a.jsx(i,{fullScreen:!0,message:"Loading group settings..."});if(M||!T)return a.jsxs("div",{className:"flex flex-col h-screen bg-white dark:bg-wa-dark-bg",children:[a.jsxs("div",{className:"h-[60px] bg-wa-grayBg dark:bg-wa-dark-header flex items-center px-4 border-b border-wa-border dark:border-wa-dark-border",children:[a.jsx("button",{onClick:()=>N(-1),className:"p-2 hover:bg-black/5 dark:hover:bg-white/10 rounded-full -ml-2",children:a.jsx(d,{size:24,className:"text-gray-700 dark:text-gray-300"})}),a.jsx("h1",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100 ml-4",children:"Group Settings"})]}),a.jsx(o,{message:M||"Group not found",onRetry:Y}),a.jsx("div",{className:"flex flex-col items-center justify-center flex-1 gap-4",children:a.jsx("button",{onClick:()=>N("/chats"),className:"px-4 py-2 bg-wa-teal text-white rounded-lg hover:bg-wa-tealDark transition-colors",children:"Back to Chats"})})]});const H=(null==(k=null==T?void 0:T.settings)?void 0:k.muteUntil)&&new Date(T.settings.muteUntil)>new Date;return a.jsxs("div",{className:"flex flex-col h-screen bg-white dark:bg-wa-dark-bg",children:[a.jsxs("div",{className:"h-[60px] bg-wa-grayBg dark:bg-wa-dark-header flex items-center px-4 border-b border-wa-border dark:border-wa-dark-border shrink-0",children:[a.jsx("button",{onClick:()=>N(-1),className:"p-2 hover:bg-black/5 dark:hover:bg-white/10 rounded-full -ml-2",children:a.jsx(d,{size:24,className:"text-gray-700 dark:text-gray-300"})}),a.jsx("h1",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100 ml-4",children:"Group Settings"})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto",children:[a.jsxs("div",{className:"bg-white dark:bg-wa-dark-paper p-4 border-b-8 border-gray-100 dark:border-wa-dark-bg",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("img",{src:T.avatar||"https://ui-avatars.com/api/?name=Group&background=128c7e&color=fff",alt:T.groupName,className:"w-16 h-16 rounded-full object-cover"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 truncate",children:T.groupName}),a.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[(null==(w=T.participants)?void 0:w.length)||0," participants"]}),(A||U)&&a.jsx("span",{className:"inline-block mt-1 px-2 py-0.5 bg-wa-teal/10 text-wa-teal text-xs rounded-full",children:U?"Owner":"Admin"})]})]}),T.description&&a.jsx("p",{className:"mt-3 text-sm text-gray-600 dark:text-gray-400",children:T.description})]}),a.jsxs("div",{className:"bg-white dark:bg-wa-dark-paper",children:[a.jsxs(j,{title:"Quick Actions",children:[a.jsx(v,{icon:H?u:m,label:H?"Unmute":"Mute",onClick:q}),a.jsx(v,{icon:x,label:"Manage Participants",onClick:()=>N(`/group/${C}/participants`),showArrow:!0}),A&&a.jsx(v,{icon:g,label:"Permissions",onClick:()=>N(`/group/${C}/permissions`),showArrow:!0})]}),a.jsx(j,{title:"Media & Files",children:a.jsx(v,{icon:p,label:"Media, Links & Docs",onClick:()=>N(`/chat/${C}/info`),showArrow:!0})}),A&&a.jsxs(j,{title:"Privacy & Notifications",children:[a.jsx(v,{icon:"private"===(null==T?void 0:T.privacy)?h:b,label:"Group Privacy",sublabel:"private"===(null==T?void 0:T.privacy)?"Private":"Public",onClick:()=>{}}),a.jsx(v,{icon:H?m:u,label:H?"Notifications Muted":"Notifications Active",onClick:q})]}),a.jsxs(j,{title:"Group Actions",children:[a.jsx(v,{icon:f,label:"Leave Group",onClick:()=>{U?R({type:"error",message:"Owner must transfer ownership before leaving"}):B({title:"Leave Group?",message:"Are you sure you want to leave this group? You can be added back by an admin.",confirmText:"Leave",confirmDanger:!0,onConfirm:async()=>{$(!0);try{const e=await l.leaveGroup(C,null==D?void 0:D.id);e.success?(R({type:"success",message:"Left group successfully"}),setTimeout(()=>N("/chats"),1e3)):R({type:"error",message:e.error||"Failed to leave group"})}catch(e){R({type:"error",message:"Error leaving group"})}finally{$(!1),B(null)}}})},danger:!0}),U&&a.jsx(v,{icon:y,label:"Delete Group",onClick:()=>{B({title:"Delete Group?",message:"This will permanently delete the group for all members. This action cannot be undone.",confirmText:"Delete",confirmDanger:!0,onConfirm:async()=>{$(!0);try{await l.deleteGroup(C),R({type:"success",message:"Group deleted successfully"}),setTimeout(()=>N("/chats"),1e3)}catch(e){R({type:"error",message:"Error deleting group"})}finally{$(!1),B(null)}}})},danger:!0})]})]})]}),Q&&a.jsx(n,{type:Q.type,message:Q.message,onClose:()=>R(null)}),O&&a.jsx(c,{isOpen:!0,title:O.title,message:O.message,confirmText:O.confirmText,cancelText:"Cancel",confirmDanger:O.confirmDanger,loading:I,onConfirm:O.onConfirm,onClose:()=>B(null)})]})},j=({title:e,children:s})=>a.jsxs("div",{className:"border-b-8 border-gray-100 dark:border-wa-dark-bg",children:[a.jsx("div",{className:"px-4 py-2",children:a.jsx("h3",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide",children:e})}),a.jsx("div",{children:s})]}),v=({icon:e,label:s,sublabel:r,onClick:t,danger:l,showArrow:i})=>a.jsxs("button",{onClick:t,className:"w-full flex items-center gap-4 px-4 py-3 hover:bg-gray-50 dark:hover:bg-wa-dark-hover transition-colors",children:[a.jsx(e,{size:22,className:l?"text-red-500":"text-gray-600 dark:text-gray-400"}),a.jsxs("div",{className:"flex-1 text-left",children:[a.jsx("span",{className:"block "+(l?"text-red-500":"text-gray-900 dark:text-gray-100"),children:s}),r&&a.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:r})]}),i&&a.jsx(d,{size:20,className:"text-gray-400 rotate-180"})]});export{k as default};
