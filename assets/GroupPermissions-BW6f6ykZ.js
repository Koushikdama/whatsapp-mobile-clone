import{u as e,j as s}from"./index-7VfhOhEA.js";import{u as a,b as r,r as t}from"./router-BlRKbG7o.js";import{g as i}from"./GroupService-BxMnZ1G7.js";import{y as n,c as d}from"./icons-FsuYV2CB.js";import"./react-vendor-Dp0kJvEn.js";import"./lottie-BmTBBIiw.js";import"./chess-Bi0BiJQc.js";const o=()=>{const d=a(),{groupId:o}=r(),{chats:c,currentUser:m}=e(),[g,p]=t.useState(null),[u,x]=t.useState({sendMessages:"everyone",editGroupInfo:"admins",addMembers:"admins",sendMedia:"everyone",pinMessages:"admins"}),[h,b]=t.useState(!1),[f,j]=t.useState(!0),[v,y]=t.useState(!1);t.useEffect(()=>{k()},[o]);const k=async()=>{try{const e=c.find(e=>e.id===o&&e.isGroup);if(e){p(e),e.permissions&&x(e.permissions);const s=await i.isAdmin(o,null==m?void 0:m.id);b(s)}}catch(e){}finally{j(!1)}},w=(e,s)=>{x(a=>({...a,[e]:s}))};return f?s.jsx("div",{className:"flex items-center justify-center h-screen bg-white dark:bg-wa-dark-bg",children:s.jsx("div",{className:"w-12 h-12 border-4 border-wa-teal border-t-transparent rounded-full animate-spin"})}):h?s.jsxs("div",{className:"flex flex-col h-screen bg-white dark:bg-wa-dark-bg",children:[s.jsxs("div",{className:"h-[60px] bg-wa-grayBg dark:bg-wa-dark-header flex items-center px-4 border-b border-wa-border dark:border-wa-dark-border shrink-0",children:[s.jsx("button",{onClick:()=>d(-1),className:"p-2 hover:bg-black/5 dark:hover:bg-white/10 rounded-full -ml-2",children:s.jsx(n,{size:24,className:"text-gray-700 dark:text-gray-300"})}),s.jsx("h1",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100 ml-4",children:"Group Permissions"})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto",children:[s.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 m-4 rounded-lg",children:s.jsx("p",{className:"text-sm text-blue-900 dark:text-blue-300",children:"Configure who can perform certain actions in this group. Changes take effect immediately for all members."})}),s.jsxs("div",{className:"bg-white dark:bg-wa-dark-paper",children:[s.jsx(l,{title:"Send Messages",description:"Who can send messages in this group",value:u.sendMessages,onChange:e=>w("sendMessages",e)}),s.jsx(l,{title:"Edit Group Info",description:"Who can change group name, photo, and description",value:u.editGroupInfo,onChange:e=>w("editGroupInfo",e)}),s.jsx(l,{title:"Add Members",description:"Who can add new participants to the group",value:u.addMembers,onChange:e=>w("addMembers",e)}),s.jsx(l,{title:"Send Media",description:"Who can send photos, videos, and files",value:u.sendMedia,onChange:e=>w("sendMedia",e)}),s.jsx(l,{title:"Pin Messages",description:"Who can pin important messages",value:u.pinMessages,onChange:e=>w("pinMessages",e)})]})]}),s.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-wa-dark-border",children:s.jsx("button",{onClick:async()=>{y(!0);try{(await i.updateGroupPermissions(o,u)).success?d(-1):alert("Failed to update permissions")}catch(e){alert("Error updating permissions")}finally{y(!1)}},disabled:v,className:"w-full py-3 bg-wa-teal text-white rounded-lg font-medium disabled:opacity-50 disabled:cursor-not-allowed hover:bg-wa-tealDark transition-colors",children:v?"Saving...":"Save Permissions"})})]}):s.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-white dark:bg-wa-dark-bg p-4",children:[s.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center mb-4",children:"Only group admins can change permissions"}),s.jsx("button",{onClick:()=>d(-1),className:"px-4 py-2 bg-wa-teal text-white rounded-lg",children:"Go Back"})]})},l=({title:e,description:a,value:r,onChange:i})=>{const[n,o]=t.useState(!1);return s.jsxs("div",{className:"border-b border-gray-200 dark:border-wa-dark-border",children:[s.jsx("button",{onClick:()=>o(!n),className:"w-full flex items-center justify-between px-4 py-4 hover:bg-gray-50 dark:hover:bg-wa-dark-hover transition-colors",children:s.jsxs("div",{className:"flex-1 text-left",children:[s.jsx("h3",{className:"font-medium text-gray-900 dark:text-gray-100",children:e}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:a}),s.jsx("p",{className:"text-sm text-wa-teal mt-1 capitalize",children:r})]})}),n&&s.jsx("div",{className:"px-4 pb-4",children:[{value:"everyone",label:"Everyone"},{value:"admins",label:"Only Admins"}].map(e=>s.jsxs("button",{onClick:()=>{i(e.value),o(!1)},className:"w-full flex items-center justify-between px-4 py-3 hover:bg-gray-50 dark:hover:bg-wa-dark-hover rounded-lg transition-colors",children:[s.jsx("span",{className:"text-gray-900 dark:text-gray-100",children:e.label}),r===e.value&&s.jsx(d,{size:20,className:"text-wa-teal"})]},e.value))})]})};export{o as default};
