import{u as e,p as t,j as a}from"./index-7VfhOhEA.js";import{b as r,u as s,r as d}from"./router-BlRKbG7o.js";import{X as i,c as n}from"./icons-FsuYV2CB.js";import"./react-vendor-Dp0kJvEn.js";import"./lottie-BmTBBIiw.js";import"./chess-Bi0BiJQc.js";const l=()=>{const{linkId:l}=r(),c=s(),{currentUser:o,addGroupParticipants:m,chats:u}=e(),[x,g]=d.useState(!0),[p,b]=d.useState(""),[h,f]=d.useState(null),[j,w]=d.useState(!1);d.useEffect(()=>{l&&(null==o?void 0:o.id)&&k()},[l,null==o?void 0:o.id]);const k=async()=>{var e;try{g(!0);const a=await t.validateInviteLink(l);if(!a.success)return b(a.error),void g(!1);const r=u.find(e=>e.id===a.groupId);if(!r)return b("Group not found"),void g(!1);if(null==(e=r.groupParticipants)?void 0:e.includes(o.id))return f(r),w(!0),g(!1),void setTimeout(()=>{c(`/chat/${a.groupId}`)},1500);f(r),await m(a.groupId,[o.id]),await t.recordLinkUsage(l),w(!0),g(!1),setTimeout(()=>{c(`/chat/${a.groupId}`)},2e3)}catch(a){b(a.message||"Failed to join group"),g(!1)}};return x?a.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-wa-grayBg dark:bg-wa-dark-bg",children:[a.jsx("div",{className:"w-12 h-12 border-4 border-wa-teal border-t-transparent rounded-full animate-spin mb-4"}),a.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Joining group..."})]}):p?a.jsx("div",{className:"flex flex-col items-center justify-center h-screen bg-wa-grayBg dark:bg-wa-dark-bg p-4",children:a.jsxs("div",{className:"bg-white dark:bg-wa-dark-paper rounded-lg p-6 max-w-md w-full text-center shadow-lg",children:[a.jsx("div",{className:"w-16 h-16 bg-red-100 dark:bg-red-900/20 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(i,{size:32,className:"text-red-500"})}),a.jsx("h2",{className:"text-xl font-medium text-[#111b21] dark:text-gray-100 mb-2",children:"Unable to Join"}),a.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:p}),a.jsx("button",{onClick:()=>c("/"),className:"px-6 py-2 bg-wa-teal text-white rounded-lg hover:bg-wa-tealDark transition-colors",children:"Go Home"})]})}):j&&h?a.jsx("div",{className:"flex flex-col items-center justify-center h-screen bg-wa-grayBg dark:bg-wa-dark-bg p-4",children:a.jsxs("div",{className:"bg-white dark:bg-wa-dark-paper rounded-lg p-6 max-w-md w-full text-center shadow-lg",children:[a.jsx("div",{className:"w-16 h-16 bg-green-100 dark:bg-green-900/20 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(n,{size:32,className:"text-green-500"})}),a.jsx("h2",{className:"text-xl font-medium text-[#111b21] dark:text-gray-100 mb-2",children:"Success!"}),a.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-2",children:"You've joined"}),a.jsx("p",{className:"text-wa-teal font-medium text-lg mb-4",children:h.groupName}),a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-500",children:"Redirecting to chat..."})]})}):null};export{l as default};
